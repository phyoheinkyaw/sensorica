<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firebase CRUD App</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Firebase SDKs (Non-Module Version) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-database-compat.js"></script>
</head>
<body>
  <div class="container mt-5">
    <h2 class="text-center">Firebase Realtime Database CRUD</h2>

    <!-- Input Form for CRUD Operations -->
    <div class="row">
      <div class="col-md-6">
        <h4>Add New Record</h4>
        <form id="addForm">
          <div class="mb-3">
            <label for="name" class="form-label">Name</label>
            <input type="text" class="form-control" id="name" placeholder="Enter name" required>
          </div>
          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input type="email" class="form-control" id="email" placeholder="Enter email" required>
          </div>
          <button type="submit" class="btn btn-primary">Add Record</button>
        </form>
      </div>
      
      <div class="col-md-6">
        <h4>Update Record</h4>
        <form id="updateForm">
          <div class="mb-3">
            <label for="updateId" class="form-label">Record ID</label>
            <input type="text" class="form-control" id="updateId" placeholder="Enter record ID" readonly required>
          </div>
          <div class="mb-3">
            <label for="updateName" class="form-label">New Name</label>
            <input type="text" class="form-control" id="updateName" placeholder="Enter new name" required>
          </div>
          <div class="mb-3">
            <label for="updateEmail" class="form-label">New Email</label>
            <input type="email" class="form-control" id="updateEmail" placeholder="Enter new email" required>
          </div>
          <button type="submit" class="btn btn-warning">Update Record</button>
        </form>
      </div>
    </div>
    
    <!-- Table to Display Records -->
    <h3 class="mt-5">All Records</h3>
    <table class="table table-bordered" id="recordsTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="recordsBody">
        <!-- Data will be populated here -->
      </tbody>
    </table>
  </div>

  <!-- Firebase Configuration and JS Code -->
  <script>
    // Your Firebase configuration from earlier
    const firebaseConfig = {
      apiKey: "AIzaSyBIKxKbI6k3ojF6Shb6samXxXcUdirYNdU",
      authDomain: "sensorica-candidates.firebaseapp.com",
      databaseURL: "https://sensorica-candidates-default-rtdb.asia-southeast1.firebasedatabase.app",  // Update this line
      projectId: "sensorica-candidates",
      storageBucket: "sensorica-candidates.appspot.com",
      messagingSenderId: "537441231318",
      appId: "1:537441231318:web:a3166f73212900bcb24477"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // Create Record
    document.getElementById('addForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const email = document.getElementById('email').value;
      
      const newRecordKey = database.ref().child('records').push().key;
      database.ref('records/' + newRecordKey).set({
        name: name,
        email: email
      });

      document.getElementById('addForm').reset();
      fetchRecords();
    });

    // Fetch and display records
    function fetchRecords() {
      const recordsBody = document.getElementById('recordsBody');
      recordsBody.innerHTML = '';
      database.ref('records').on('value', function (snapshot) {
        const records = snapshot.val();
        for (let key in records) {
          const record = records[key];
          const row = `
            <tr>
              <td>${key}</td>
              <td>${record.name}</td>
              <td>${record.email}</td>
              <td>
                <button class="btn btn-info" onclick="editRecord('${key}')">Edit</button>
                <button class="btn btn-danger" onclick="deleteRecord('${key}')">Delete</button>
              </td>
            </tr>
          `;
          recordsBody.innerHTML += row;
        }
      });
    }

    // Edit Record (Populates the update form)
    function editRecord(id) {
      const recordRef = database.ref('records/' + id);
      recordRef.once('value').then(function (snapshot) {
        const record = snapshot.val();
        document.getElementById('updateId').value = id;
        document.getElementById('updateName').value = record.name;
        document.getElementById('updateEmail').value = record.email;
      });
    }

    // Delete Record
    function deleteRecord(id) {
      database.ref('records/' + id).remove();
      fetchRecords();
    }

    // Update Record
    document.getElementById('updateForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const updateId = document.getElementById('updateId').value;
      const updateName = document.getElementById('updateName').value;
      const updateEmail = document.getElementById('updateEmail').value;

      database.ref('records/' + updateId).update({
        name: updateName,
        email: updateEmail
      });

      document.getElementById('updateForm').reset();
      fetchRecords();
    });

    // Fetch records initially
    fetchRecords();
  </script>
</body>
</html>
